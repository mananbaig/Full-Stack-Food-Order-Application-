@model IEnumerable<FoodItem>
@{
    Layout = "_myLayout";
    ViewData["Title"] = "Our Menu";
}
<link rel="stylesheet" href="~/css/menu.css">

<section class="menu-section">
    <div class="container">
        <h2 class="section-title">🍽️ Our Delicious Menu</h2>
        <p class="section-subtitle">Handpicked dishes crafted with love and finest ingredients</p>

        <div class="row gy-5 mt-5">
            @foreach (var item in Model)
            {
                <div class="col-lg-4 col-md-6 col-sm-12">
                    <div class="menu-card @(!item.isAvailable ? "unavailable" : "")">
                        <!-- Clickable area (image + title/desc) -->
                        <a asp-controller="Menu" asp-action="Details" asp-route-id="@item.FoodId" class="menu-link">
                            <div class="menu-img-wrapper">
                                @if (item.isAvailable)
                                {
                                    <span class="menu-badge available-badge">✓ Available</span>
                                }
                                else
                                {
                                    <span class="menu-badge unavailable-badge">✕ Unavailable</span>
                                    <div class="unavailable-text">SOLD OUT</div>
                                }

                                <img src="@item.ImageUrl" alt="@item.Name" class="menu-img"
                                     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22250%22 height=%22250%22%3E%3Crect fill=%22%23e0e0e0%22 width=%22250%22 height=%22250%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2220%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 fill=%22%23999%22%3ENo Image%3C/text%3E%3C/svg%3E'" />

                                <div class="menu-overlay"></div>
                            </div>

                            <div class="card-body">
                                <h3 class="menu-title">@item.Name</h3>
                                <p class="menu-desc">@item.Description</p>
                            </div>
                        </a>

                        <!-- Footer (actions) kept outside clickable link to avoid nested interactive elements -->
                        <div class="card-body footer-body">
                            <div class="menu-footer">
                                <span class="menu-price">Rs. @item.Price</span>

                                @if (item.isAvailable)
                                {
                                    <form asp-controller="Menu" asp-action="AddToCart" method="post" style="display:inline;">
                                        <input type="hidden" name="foodId" value="@item.FoodId" />
                                        <input type="hidden" name="quantity" value="1" />
                                        <button type="submit" class="btn-add-cart" title="Add to Cart">
                                            <i class="fas fa-shopping-cart"></i>
                                        </button>
                                    </form>
                                }
                                else
                                {
                                    <button class="btn-add-cart" disabled title="Out of stock">
                                        <i class="fas fa-ban"></i>
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>